discovery.kubernetes "pods" {
  role = "pod"
}

loki.process.kubernetes "default" {
  forward_to = [loki.source.file.app_logs.receiver]
  pod_associations = ["pod_name"]
  discovery = discovery.kubernetes.pods
}

local.file_match "app_logs" {
  path_targets = [{
    __path__ = "/logs/*.log"
  }]
  forward_to = [loki.process.kubernetes.default.receiver]
}

loki.source.file "app_logs" {
  forward_to = [loki.write.default.receiver]
}
