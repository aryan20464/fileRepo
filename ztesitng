server {
    listen 80;
    server_name yourdomain.com;

    location /apache-home/ {
        proxy_pass http://localhost:9080/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /manager/ {
        proxy_pass http://localhost:9080/manager/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Authorization $http_authorization;
    }
}

















#!/bin/bash

export JAVA_HOME=/usr/lib/jvm/java-17-openjdk
export CATALINA_HOME=/devtools/apache-tomcat
export CATALINA_BASE=/devtools/apache-tomcat
export JAVA_OPTS="-Xms512M -Xmx1024M -XX:+UseG1GC -Djava.security.egd=file:/dev/./urandom"



discovery.kubernetes "pods" {
  selectors = [
    {
      role = "pod"
      namespace = "uatcmm"
      label_selectors = {
        "app" = "springboot-app"
      }
    }
  ]
}

loki.source.podlogs "springboot_logs" {
  forward_to = [loki.write.default.receiver]
  targets    = discovery.kubernetes.pods.targets
  include    = {
    namespace = "uatcmm"
  }
}

loki.write "default" {
  endpoint {
    url = "http://loki.loki.svc.cluster.local:3100/loki/api/v1/push"
  }
}
