D:\chakri\tanzu\ks-vks\test>kubectl logs nginx-cmm-5f5c5576bc-w6mtg -n uatcmm
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
/docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
10-listen-on-ipv6-by-default.sh: info: /etc/nginx/conf.d/default.conf is not a file or does not exist
/docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
/docker-entrypoint.sh: Configuration complete; ready for start up
2025/09/16 06:26:15 [emerg] 1#1: bind() to 0.0.0.0:80 failed (13: Permission denied)
nginx: [emerg] bind() to 0.0.0.0:80 failed (13: Permission denied)

kubectl get ingress -n uatcmm
NAME      CLASS                 HOSTS         ADDRESS        PORTS   AGE
cmm-ing   cmmuat-ingressclass   cmm-uat.sbi   10.177.107.9   80      74d









[weblogic@tss-ideaappuat nginx-log-exporter]$ ./prometheus-nginxlog-exporter -config-file logexporter.yaml -log-level debug
2025-07-30T11:34:22.685+0530    info    prometheus-nginxlog-exporter/main.go:162        loading configuration file logexporter.yaml
2025-07-30T11:34:22.686+0530    warn    config/struct_namespace.go:98   No globs for /node/nginx/logs/access.log
2025-07-30T11:34:22.686+0530    debug   prometheus-nginxlog-exporter/main.go:119        using configuration {Listen:{Port:4040 Address:0.0.0.0 MetricsEndpoint:/metrics} Consul:{Enable:false Address: Datacenter: Scheme: Token: Service:{ID: Name: Address: Tags:[]}} Namespaces:[{Name:nginx NamespaceLabelName: NamespaceLabels:map[] MetricsOverride:<nil> NamespacePrefix: SourceFiles:[/node/nginx/logs/access.log] SourceData:{Files:[/node/nginx/logs/access.log] Syslog:<nil>} Parser: Format:Ip=$remote_addr time=$remote_user [$time_local] Request="$request" Status=$status Request_size=$body_bytes_sent URL="$http_referer" Client="$http_user_agent" rt=$request_time uct="$upstream_connect_time" uht="$upstream_header_time" urt="$upstream_response_time" Labels:map[app:nginx] RelabelConfigs:[] HistogramBuckets:[0.001 0.01 0.05 0.1 0.3 0.5 1 2 5] PrintLog:false OrderedLabelNames:[] OrderedLabelValues:[]}] EnableExperimentalFeatures:false EnableExperimentalFeaturesOld:false}
2025-07-30T11:34:22.687+0530    info    prometheus-nginxlog-exporter/main.go:139        starting listener for namespace nginx
2025-07-30T11:34:22.687+0530    info    prometheus-nginxlog-exporter/main.go:148        running HTTP server on address 0.0.0.0:4040, serving metrics at /metrics

Below Storage to be decided  by AO

Object Storage (For Quay)
URL
Bucket Name
Access Key
Secret Key
Valid Certificate

Object Storage (For Loki)
URL
Bucket Name
Access Key
Secret Key
Valid Certificate

NFS (For Internal Registry)
Storage - 500 GB
NFS Path
Access  - Read Write

NFS (ETCD Cron Job)
Storage - 750 GB
NFS Path -
Access - Read Write

NFS (3Scale)
Storage - 
NFS Path -
Access - Read Write


crc setup --log-level debug
DEBU CRC version: 2.53.0+a6f712
DEBU OpenShift version: 4.19.3
DEBU MicroShift version: 4.19.0
DEBU Running 'crc setup'
INFO Using bundle path C:\Users\1064695\.crc\cache\crc_hyperv_4.19.3_amd64.crcbundle
INFO Checking minimum RAM requirements
DEBU Total memory of system is 34190172160 bytes
INFO Check if Podman binary exists in: C:\Users\1064695\.crc\bin\oc
INFO Checking if running in a shell with administrator rights
DEBU Running '$currentPrincipal = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent());$currentPrincipal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)'
DEBU Command failed: fork/exec C:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exe: Access is denied.
DEBU stdout:
DEBU stderr:
INFO Checking Windows release
DEBU Running '(Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion" -Name ReleaseId).ReleaseId'
DEBU Command failed: fork/exec C:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exe: Access is denied.
DEBU stdout:
DEBU stderr:
DEBU fork/exec C:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exe: Access is denied.
DEBU Failed to get Windows release id
ERRO Please manually update your Windows 10 installation

curl -i http://localhost:4040/metrics
HTTP/1.1 200 OK
Content-Type: text/plain; version=0.0.4; charset=utf-8
Date: Tue, 29 Jul 2025 12:29:26 GMT
Content-Length: 467

# HELP prometheus_nginxlog_exporter_build_info A metric with a constant '1' value labeled by version, revision, branch, goversion from which prometheus_nginxlog_exporter was built, and the goos and goarch for the build.
# TYPE prometheus_nginxlog_exporter_build_info gauge
prometheus_nginxlog_exporter_build_info{branch="v1.11.0",goarch="amd64",goos="linux",goversion="go1.18.10",revision="76552e7cadc1f76b4e28b5c872412db4a091aca0",tags="unknown",version="1.11.0"} 1

https://accounts.google.com/ServiceLogin?passive=1209600&continue=https://cloud.google.com/innovators/getcertified?mkt_tok%3DODA4LUdKVy0zMTQAAAGcruImhRZWxNA-yz_ANCI54Z2IO0vq38IreIg6-VMIu9HPxNwYAF3LiMNKQIVDoaJ3X7AFLbSrB3uo3sr59IR9YsXzRsPS2n1XjjMaMjFmw2IBfsNXxCI&followup=https://cloud.google.com/innovators/getcertified?mkt_tok%3DODA4LUdKVy0zMTQAAAGcruImhRZWxNA-yz_ANCI54Z2IO0vq38IreIg6-VMIu9HPxNwYAF3LiMNKQIVDoaJ3X7AFLbSrB3uo3sr59IR9YsXzRsPS2n1XjjMaMjFmw2IBfsNXxCI


local.file_match "app_logs" {
  path_targets = [{ "__path__" = "/logs/*.log" }]
}

loki.source.file "app_logs" {
  targets    = local.file_match.app_logs.targets
  forward_to = [loki.process.add_app_labels.receiver]
}

loki.process "add_app_labels" {
  stage.static_labels {
    values = {
      service_name = "Starter"
      pod_name     = "linux-host"  # Replace or set via env("HOSTNAME") if needed
    }
  }
  forward_to = [loki.write.default.receiver]
}

loki.write "default" {
  endpoint {
    url = "http://localhost:3100/loki/api/v1/push"
  }
}


server {
    listen 80;
    server_name yourdomain.com;

    location /grafana/ {
        proxy_pass         http://localhost:3000/;
        proxy_set_header   Host $host;
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
        rewrite ^/grafana/(.*) /$1 break;
    }
}


[server]
root_url = http://192.168.1.100/grafana/
serve_from_sub_path = true


auth_enabled: false

server:
  http_listen_port: 3100
  log_level: info

ingester:
  lifecycler:
    ring:
      kvstore:
        store: inmemory
      replication_factor: 1
  final_sleep: 0s
  chunk_idle_period: 5m
  max_chunk_age: 1h

schema_config:
  configs:
    - from: 2024-01-01
      store: boltdb-shipper
      object_store: filesystem
      schema: v13
      index:
        prefix: index_
        period: 24h

storage_config:
  boltdb_shipper:
    active_index_directory: /tmp/loki/index
    cache_location: /tmp/loki/boltdb-cache
    shared_store: filesystem
  filesystem:
    directory: /tmp/loki/chunks

limits_config:
  enforce_metric_name: false
  reject_old_samples: true
  reject_old_samples_max_age: 168h

chunk_store_config:
  max_look_back_period: 0s

table_manager:
  retention_deletes_enabled: false
  retention_period: 0s


server "http" {
  listen_address = "0.0.0.0:12345" # Alloy UI/metrics port
  log_level      = "info"
}

local.file_match "app_logs" {
  path_targets = {
    "app" = "/uat/xsys/app.log"
  }
  forward_to = [loki.write.default.receiver]
}

loki.write "default" {
  endpoint {
    url = "http://localhost:3100/loki/api/v1/push"
  }
}
