 @Query("SELECT bi FROM BranchIndent bi where bi.indentStatus=2 and bi.receivedDate is null and requestedDate <= CURRENT_DATE - :days order by indentID DESC, id DESC")
    List<BranchIndent> findEntriesPendingForEntryInCBSAtBranches(@Param("days") int days);


kubectl get storageclass
NAME                       PROVISIONER              RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
h06-vks-sp-2 (default)     csi.vsphere.vmware.com   Delete          Immediate              true                   95d
h06-vks-sp-2-latebinding   csi.vsphere.vmware.com   Delete          WaitForFirstConsumer   true                   95d



kubectl get pvc -n kube-monitoring
NAME             STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE
pvc-grafana      Bound    pvc-6bb723e8-73b9-49d0-b8ed-84b35fcbef89   5Gi        RWO            h06-vks-sp-2   <unset>                 59m
pvc-loki         Bound    pvc-16dca3b9-131e-462e-8f8c-b61289adb711   30Gi       RWO            h06-vks-sp-2   <unset>                 59m
pvc-prometheus   Bound    pvc-e136f4c7-7a23-45f4-85fa-7b1a39162498   10Gi       RWO            h06-vks-sp-2   <unset>                 59m





kubectl get pvc -n kube-monitoring
NAME             STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE
pvc-grafana      Bound    pvc-6bb723e8-73b9-49d0-b8ed-84b35fcbef89   5Gi        RWO            h06-vks-sp-2   <unset>                 53m
pvc-loki         Bound    pvc-16dca3b9-131e-462e-8f8c-b61289adb711   30Gi       RWO            h06-vks-sp-2   <unset>                 53m
pvc-prometheus   Bound    pvc-e136f4c7-7a23-45f4-85fa-7b1a39162498   10Gi       RWO            h06-vks-sp-2   <unset>                 53m

C:\Users\1064695>kubectl describe pvc pvc-grafana -n kube-monitoring
Name:          pvc-grafana
Namespace:     kube-monitoring
StorageClass:  h06-vks-sp-2
Status:        Bound
Volume:        pvc-6bb723e8-73b9-49d0-b8ed-84b35fcbef89
Labels:        <none>
Annotations:   pv.kubernetes.io/bind-completed: yes
               pv.kubernetes.io/bound-by-controller: yes
               volume.beta.kubernetes.io/storage-provisioner: csi.vsphere.vmware.com
               volume.kubernetes.io/storage-provisioner: csi.vsphere.vmware.com
               volumehealth.storage.kubernetes.io/health: accessible
               volumehealth.storage.kubernetes.io/health-timestamp: Tue Oct  7 06:01:04 UTC 2025
Finalizers:    [kubernetes.io/pvc-protection]
Capacity:      5Gi
Access Modes:  RWO
VolumeMode:    Filesystem
Used By:       <none>
Events:
  Type    Reason                 Age   From                                                                                                 Message
  ----    ------                 ----  ----                                                                                                 -------
  Normal  ExternalProvisioning   53m   persistentvolume-controller                                                                          Waiting for a volume to be created either by the external provisioner 'csi.vsphere.vmware.com' or manually by the system administrator. If volume creation is delayed, please verify that the provisioner is running and correctly registered.
  Normal  Provisioning           53m   csi.vsphere.vmware.com_vsphere-csi-controller-74f5578cc4-g5grd_6d830da4-64e6-4d6a-b80f-a6addba2f621  External provisioner is provisioning volume for claim "kube-monitoring/pvc-grafana"
  Normal  ProvisioningSucceeded  53m   csi.vsphere.vmware.com_vsphere-csi-controller-74f5578cc4-g5grd_6d830da4-64e6-4d6a-b80f-a6addba2f621  Successfully provisioned volume pvc-6bb723e8-73b9-49d0-b8ed-84b35fcbef89



















kubectl describe deployment grafana -n kube-monitoring
Name:                   grafana
Namespace:              kube-monitoring
CreationTimestamp:      Tue, 07 Oct 2025 12:17:40 +0530
Labels:                 <none>
Annotations:            deployment.kubernetes.io/revision: 1
Selector:               app=grafana
Replicas:               1 desired | 0 updated | 0 total | 0 available | 1 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  app=grafana
  Containers:
   grafana:
    Image:      h06vksharbor.corp.ad.sbi/itss/grafana:12.3.0
    Port:       3000/TCP
    Host Port:  0/TCP
    Environment:
      GF_PATHS_PROVISIONING:  /etc/grafana/provisioning
    Mounts:
      /etc/grafana/provisioning/datasources from grafana-datasources (rw)
      /var/lib/grafana from grafana-storage (rw)
  Volumes:
   grafana-storage:
    Type:       PersistentVolumeClaim (a reference to a PersistentVolumeClaim in the same namespace)
    ClaimName:  pvc-grafana
    ReadOnly:   false
   grafana-datasources:
    Type:      ConfigMap (a volume populated by a ConfigMap)
    Name:      grafana-datasources
    Optional:  false
Conditions:
  Type             Status  Reason
  ----             ------  ------
  Progressing      True    NewReplicaSetCreated
  Available        False   MinimumReplicasUnavailable
  ReplicaFailure   True    FailedCreate
OldReplicaSets:    <none>
NewReplicaSet:     grafana-67d565b8df (0/1 replicas created)
Events:
  Type    Reason             Age   From                   Message
  ----    ------             ----  ----                   -------
  Normal  ScalingReplicaSet  39s   deployment-controller  Scaled up replica set grafana-67d565b8df from 0 to 1






mvn dependency:resolve-sources -U
[WARNING] 
[WARNING] Some problems were encountered while building the effective settings
[WARNING] Unrecognised tag: 'servers' (position: START_TAG seen ...</server>\r\n    -->\r\n<servers>... @135:10)  @ D:\dev-tools\apache-maven-3.8.5-bin\apache-maven-3.8.5\conf\settings.xml, line 135, column 10
[WARNING]
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  0.832 s
[INFO] Finished at: 2025-09-18T17:27:48+05:30
[INFO] ------------------------------------------------------------------------
[ERROR] Could not find goal 'resolve-sources' in plugin org.apache.maven.plugins:maven-dependency-plugin:3.3.0 among available goals analyze, analyze-dep-mgt, analyze-duplicate, analyze-only, analyze-report, build-classpath, collect, copy, copy-dependencies, display-ancestors, get, go-offline, help, list, list-classes, list-repositories, properties, purge-local-repository, resolve, resolve-plugins, sources, tree, unpack, unpack-dependencies -> [Help 1]
[ERROR]



<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
		 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		 xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>2.7.0</version>
		<relativePath/>
		<!-- lookup parent from repository -->
	</parent>
	<groupId>com.sbi</groupId>
	<artifactId>dbcon</artifactId>
	<packaging>jar</packaging>
	<name>dbcon</name>
	<description>idh Service For hdg</description>
	<properties>
		<java.version>1.8</java.version>
	</properties>
	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter</artifactId>
			<exclusions>
				<exclusion>
					<groupId>org.springframework.boot</groupId>
					<artifactId>spring-boot-starter-logging</artifactId>
				</exclusion>
			</exclusions>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
			<exclusions>
				<exclusion>
					<groupId>org.junit.vintage</groupId>
					<artifactId>junit-vintage-engine</artifactId>
				</exclusion>
			</exclusions>
		</dependency>
		<dependency>
			<groupId>org.projectlombok</groupId>
			<artifactId>lombok</artifactId>
			<optional>true</optional>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-tomcat</artifactId>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.hibernate</groupId>
			<artifactId>hibernate-envers</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<scope>runtime</scope>
			<optional>true</optional>
		</dependency>
		<dependency>
			<groupId>com.oracle.database.jdbc</groupId>
			<artifactId>ojdbc8</artifactId>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.httpcomponents</groupId>
			<artifactId>httpclient</artifactId>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>com.fasterxml.jackson.core</groupId>
			<artifactId>jackson-annotations</artifactId>
		</dependency>
		<dependency>
			<groupId>com.google.code.gson</groupId>
			<artifactId>gson</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-log4j2</artifactId>
		</dependency>
		<dependency>
			<groupId>javax.servlet</groupId>
			<artifactId>javax.servlet-api</artifactId>
			<version>3.0.1</version>
			<scope>provided</scope>
		</dependency>
		<!-- https://mvnrepository.com/artifact/org.apache.commons/commons-lang3 -->
		<dependency>
			<groupId>org.apache.commons</groupId>
			<artifactId>commons-lang3</artifactId>
		</dependency>
		<!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind -->
		<dependency>
			<groupId>com.fasterxml.jackson.core</groupId>
			<artifactId>jackson-databind</artifactId>
			<version>2.13.4</version>
		</dependency>
		<!-- JSON WEB TOKEN -->
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt</artifactId>
			<version>0.9.0</version>
		</dependency>
		<dependency>
			<groupId>org.jetbrains</groupId>
			<artifactId>annotations</artifactId>
			<version>17.0.0</version>
			<scope>compile</scope>
		</dependency>
		<!--added by chakri on 20241023 for sending email -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-mail</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jpa</artifactId>
		</dependency>
	</dependencies>
	<build>
		<finalName>${project.artifactId}</finalName>
		<plugins>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
				<configuration>
					<excludes>
						<exclude>
							<groupId>org.projectlombok</groupId>
							<artifactId>lombok</artifactId>
						</exclude>
					</excludes>
				</configuration>
			</plugin>
		</plugins>
		<resources>
			<resource>
				<directory>src/main/resources</directory>
				<filtering>true</filtering>
				<includes>
					<include>**/*.properties</include>
					<include>**/*.txt</include>
				</includes>
			</resource>
		</resources>
	</build>
	<profiles>
		<profile>
			<id>local2</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
			<properties>
				<spring.profiles.active>local2</spring.profiles.active>
			</properties>
		</profile>
		<profile>
			<id>local1</id>
			<properties>
				<spring.profiles.active>local1</spring.profiles.active>
			</properties>
		</profile>
		<profile>
			<id>local</id>
			<properties>
				<spring.profiles.active>local</spring.profiles.active>
			</properties>
		</profile>
		<profile>
			<id>uat</id>
			<properties>
				<spring.profiles.active>uat</spring.profiles.active>
			</properties>
		</profile>
		<profile>
			<id>prod</id>
			<properties>
				<spring.profiles.active>prod</spring.profiles.active>
			</properties>
		</profile>
		<profile>
			<id>dr</id>
			<properties>
				<spring.profiles.active>dr</spring.profiles.active>
			</properties>
		</profile>
		<profile>
			<id>dev</id>
			<properties>
				<spring.profiles.active>dev</spring.profiles.active>
			</properties>
		</profile>
	</profiles>
</project>

Running with gitlab-runner 16.8.1 (a6097117)
  on custom-runner TAP5h3h8a, system ID: s_03cc683b0faa
Preparing the "shell" executor
00:00
Using Shell (bash) executor...
Preparing environment
00:01
Running on tss-ideasvnuat...
Getting source from Git repository
00:00
Fetching changes with git depth set to 20...
Reinitialized existing Git repository in /devtools/gitlab-runner/builds/TAP5h3h8a/0/cicd/dbcon/.git/
Checking out b9b53ae6 as detached HEAD (ref is main)...
Skipping Git submodules setup
Executing "step_script" stage of the job script
00:03
$ echo "Using Maven repo at $MAVEN_REPO"
Using Maven repo at /devtools/gitlab-runner/.m2/repository
$ mkdir -p $MAVEN_REPO
$ export PATH="$MAVEN_HOME/bin:$PATH"
$ java -version
java version "1.8.0_271"
Java(TM) SE Runtime Environment (build 1.8.0_271-b09)
Java HotSpot(TM) 64-Bit Server VM (build 25.271-b09, mixed mode)
$ mvn -version
Apache Maven 3.8.5 (3599d3414f046de2324203b78ddcf9b5e4388aa0)
Maven home: /devtools/maven/apache-maven-3.8.5
Java version: 1.8.0_271, vendor: Oracle Corporation, runtime: /usr/java/jdk1.8.0_271-amd64/jre
Default locale: en_IN, platform encoding: UTF-8
OS name: "linux", version: "4.18.0-553.66.1.el8_10.x86_64", arch: "amd64", family: "unix"
$ mvn $MAVEN_CLI_OPTS clean package
[INFO] Scanning for projects...
[WARNING] 
[WARNING] Some problems were encountered while building the effective model for com.sbi:dbcon:jar:2.7.0
[WARNING] 'dependencies.dependency.(groupId:artifactId:type:classifier)' must be unique: com.oracle.database.jdbc:ojdbc8:jar -> duplicate declaration of version (?) @ line 127, column 15
[WARNING] 
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING] 
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[WARNING] 
[INFO] 
[INFO] ---------------------------< com.sbi:dbcon >----------------------------
[INFO] Building dbcon 2.7.0
[INFO] --------------------------------[ jar ]---------------------------------
[WARNING] The POM for net.minidev:json-smart:jar:2.4.8 is missing, no dependency information available
[WARNING] The POM for net.bytebuddy:byte-buddy:jar:1.12.10 is missing, no dependency information available
[WARNING] The POM for net.bytebuddy:byte-buddy-agent:jar:1.12.10 is missing, no dependency information available
[WARNING] The POM for org.glassfish.jaxb:jaxb-runtime:jar:2.3.6 is missing, no dependency information available
[WARNING] The POM for org.apache.httpcomponents:httpcore:jar:4.4.15 is missing, no dependency information available
[WARNING] The POM for commons-codec:commons-codec:jar:1.15 is missing, no dependency information available
[WARNING] The POM for com.sun.activation:jakarta.activation:jar:1.2.2 is missing, no dependency information available
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  0.899 s
[INFO] Finished at: 2025-09-18T17:15:50+05:30
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal on project dbcon: Could not resolve dependencies for project com.sbi:dbcon:jar:2.7.0: The following artifacts could not be resolved: net.minidev:json-smart:jar:2.4.8, org.slf4j:slf4j-api:jar:1.7.36, net.bytebuddy:byte-buddy:jar:1.12.10, net.bytebuddy:byte-buddy-agent:jar:1.12.10, org.glassfish.jaxb:jaxb-runtime:jar:2.3.6, org.apache.httpcomponents:httpcore:jar:4.4.15, commons-codec:commons-codec:jar:1.15, com.sun.activation:jakarta.activation:jar:1.2.2: Cannot access central (https://repo.maven.apache.org/maven2) in offline mode and the artifact net.minidev:json-smart:jar:2.4.8 has not been downloaded from it before. -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/DependencyResolutionException
Cleaning up project directory and file based variables
00:00
ERROR: Job failed: exit status 1







stages:
  - build

variables:
  MAVEN_REPO: "/devtools/gitlab-runner/.m2/repository"
  MAVEN_CLI_OPTS: "-B -Dmaven.test.skip=true -Dmaven.repo.local=$MAVEN_REPO"
  JAVA_HOME: "/devtools/java/jdk1.8.0_401"
  MAVEN_HOME: "/devtools/maven/apache-maven-3.8.5"

build-war:
  stage: build
  script:
    - echo "Using Maven repo at $MAVEN_REPO"
    - mkdir -p $MAVEN_REPO
    - export PATH="$JAVA_HOME/bin:$MAVEN_HOME/bin:$PATH"

    # Verify Java & Maven versions being used
    - java -version
    - mvn -version

    # Build the WAR
    - mvn $MAVEN_CLI_OPTS clean package
  artifacts:
    paths:
      - target/*.war
  only:
    - release   # trigger only when pushing to release branch










[[runners]]
  name = "custom-runner"
  url = "https://gitlab.example.com:10000/"
  token = "REGISTERED_TOKEN_FROM_GITLAB"
  executor = "shell"
  tls-ca-file = "/devtools/gitlab-runner/gitlab.crt"



/devtools/maven/apache-maven-3.9.11/bin/mvn --version
Failed to load native library:jansi-2.4.2-89cd0d7fff2e5a04-libjansi.so. The native library file at /tmp/jansi-2.4.2-89cd0d7fff2e5a04-libjansi.so is not executable, make sure that the directory is mounted on a partition without the noexec flag, or set the jansi.tmpdir system property to point to a proper location.  osinfo: Linux/x86_64
java.lang.UnsatisfiedLinkError: /tmp/jansi-2.4.2-89cd0d7fff2e5a04-libjansi.so: /tmp/jansi-2.4.2-89cd0d7fff2e5a04-libjansi.so: failed to map segment from shared object
Apache Maven 3.9.11 (3e54c93a704957b63ee3494413a2b544fd3d825b)
Maven home: /devtools/maven/apache-maven-3.9.11
Java version: 1.8.0_271, vendor: Oracle Corporation, runtime: /usr/java/jdk1.8.0_271-amd64/jre
Default locale: en_IN, platform encoding: UTF-8
OS name: "linux", version: "4.18.0-553.66.1.el8_10.x86_64", arch: "amd64", family: "unix"



https://gitlab.com/gitlab-org/gitlab-runner/-/releases/v16.8.1/downloads/packages/rpm/gitlab-runner_amd64.rpm

export JAVA_OPTS="-Xms512M -Xmx1024M -XX:+UseG1GC -Djava.security.egd=file:/dev/./urandom"
D:\chakri\tanzu\ks-vks\test>kubectl logs nginx-cmm-5f5c5576bc-w6mtg -n uatcmm
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
/docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
10-listen-on-ipv6-by-default.sh: info: /etc/nginx/conf.d/default.conf is not a file or does not exist
/docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
/docker-entrypoint.sh: Configuration complete; ready for start up
2025/09/16 06:26:15 [emerg] 1#1: bind() to 0.0.0.0:80 failed (13: Permission denied)
nginx: [emerg] bind() to 0.0.0.0:80 failed (13: Permission denied)

kubectl get ingress -n uatcmm
NAME      CLASS                 HOSTS         ADDRESS        PORTS   AGE
cmm-ing   cmmuat-ingressclass   cmm-uat.sbi   10.177.107.9   80      74d


2025/09/16 06:37:15 [emerg] 1#1: open() "/var/run/nginx.pid" failed (13: Permission denied)
nginx: [emerg] open() "/var/run/nginx.pid" failed (13: Permission denied)


apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    ako.vmware.com/controller-cluster-uuid: cluster-13e84635-e75a-4134-b68f-cd2069bd5e88
    ako.vmware.com/host-fqdn-vs-uuid-map: '{"cmm-uat.sbi":"virtualservice-9436f684-5398-4708-b213-d4dfbe5ac592"}'
    ako.vmware.com/tenant-name: admin
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"networking.k8s.io/v1","kind":"Ingress","metadata":{"annotations":{},"name":"cmm-ing","namespace":"uatcmm"},"spec":{"ingressClassName":"cmmuat-ingressclass","rules":[{"host":"cmm-uat.sbi","http":{"paths":[{"backend":{"service":{"name":"kubernetes","port":{"number":443}}},"path":"/","pathType":"ImplementationSpecific"}]}}]}}
  creationTimestamp: "2025-07-03T15:54:05Z"
  generation: 1
  name: cmm-ing
  namespace: uatcmm
  resourceVersion: "5989"
  uid: 3298ea09-e7a8-4d93-b092-5efa951547f1
spec:
  ingressClassName: cmmuat-ingressclass
  rules:
  - host: cmm-uat.sbi
    http:
      paths:
      - backend:
          service:
            name: kubernetes
            port:
              number: 443
        path: /
        pathType: ImplementationSpecific
status:
  loadBalancer:
    ingress:
    - hostname: cmm-uat.sbi
      ip: 10.177.107.9

apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    ako.vmware.com/controller-cluster-uuid: cluster-d1b2dc1e-9884-4fec-8248-d9be3306d249
    ako.vmware.com/host-fqdn-vs-uuid-map: '{"cmm-uat.sbi":"virtualservice-8243db71-f167-4558-9b17-8d2b70d2e03d"}'
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"networking.k8s.io/v1","kind":"Ingress","metadata":{"annotations":{"nginx.ingress.kubernetes.io/rewrite-target":"/"},"name":"minimal-ingress","namespace":"uatcmm"},"spec":{"ingressClassName":"uatcmm","rules":[{"host":"cmm-uat.sbi","http":{"paths":[{"backend":{"service":{"name":"nginx-cmm-service","port":{"number":80}}},"path":"/","pathType":"Prefix"}]}}]}}
    nginx.ingress.kubernetes.io/rewrite-target: /
  creationTimestamp: "2024-12-24T10:56:18Z"
  generation: 1
  name: minimal-ingress
  namespace: uatcmm
  resourceVersion: "76971686"
  uid: 5514c861-b1f3-4263-a377-6eddf353b751
spec:
  ingressClassName: uatcmm
  rules:
  - host: cmm-uat.sbi
    http:
      paths:
      - backend:
          service:
            name: nginx-cmm-service
            port:
              number: 80
        path: /
        pathType: Prefix
status:
  loadBalancer:
    ingress:
    - hostname: cmm-uat.sbi
      ip: 10.177.151.52



[weblogic@tss-ideaappuat nginx-log-exporter]$ ./prometheus-nginxlog-exporter -config-file logexporter.yaml -log-level debug
2025-07-30T11:34:22.685+0530    info    prometheus-nginxlog-exporter/main.go:162        loading configuration file logexporter.yaml
2025-07-30T11:34:22.686+0530    warn    config/struct_namespace.go:98   No globs for /node/nginx/logs/access.log
2025-07-30T11:34:22.686+0530    debug   prometheus-nginxlog-exporter/main.go:119        using configuration {Listen:{Port:4040 Address:0.0.0.0 MetricsEndpoint:/metrics} Consul:{Enable:false Address: Datacenter: Scheme: Token: Service:{ID: Name: Address: Tags:[]}} Namespaces:[{Name:nginx NamespaceLabelName: NamespaceLabels:map[] MetricsOverride:<nil> NamespacePrefix: SourceFiles:[/node/nginx/logs/access.log] SourceData:{Files:[/node/nginx/logs/access.log] Syslog:<nil>} Parser: Format:Ip=$remote_addr time=$remote_user [$time_local] Request="$request" Status=$status Request_size=$body_bytes_sent URL="$http_referer" Client="$http_user_agent" rt=$request_time uct="$upstream_connect_time" uht="$upstream_header_time" urt="$upstream_response_time" Labels:map[app:nginx] RelabelConfigs:[] HistogramBuckets:[0.001 0.01 0.05 0.1 0.3 0.5 1 2 5] PrintLog:false OrderedLabelNames:[] OrderedLabelValues:[]}] EnableExperimentalFeatures:false EnableExperimentalFeaturesOld:false}
2025-07-30T11:34:22.687+0530    info    prometheus-nginxlog-exporter/main.go:139        starting listener for namespace nginx
2025-07-30T11:34:22.687+0530    info    prometheus-nginxlog-exporter/main.go:148        running HTTP server on address 0.0.0.0:4040, serving metrics at /metrics

Below Storage to be decided  by AO

Object Storage (For Quay)
URL
Bucket Name
Access Key
Secret Key
Valid Certificate

Object Storage (For Loki)
URL
Bucket Name
Access Key
Secret Key
Valid Certificate

NFS (For Internal Registry)
Storage - 500 GB
NFS Path
Access  - Read Write

NFS (ETCD Cron Job)
Storage - 750 GB
NFS Path -
Access - Read Write

NFS (3Scale)
Storage - 
NFS Path -
Access - Read Write


crc setup --log-level debug
DEBU CRC version: 2.53.0+a6f712
DEBU OpenShift version: 4.19.3
DEBU MicroShift version: 4.19.0
DEBU Running 'crc setup'
INFO Using bundle path C:\Users\1064695\.crc\cache\crc_hyperv_4.19.3_amd64.crcbundle
INFO Checking minimum RAM requirements
DEBU Total memory of system is 34190172160 bytes
INFO Check if Podman binary exists in: C:\Users\1064695\.crc\bin\oc
INFO Checking if running in a shell with administrator rights
DEBU Running '$currentPrincipal = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent());$currentPrincipal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)'
DEBU Command failed: fork/exec C:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exe: Access is denied.
DEBU stdout:
DEBU stderr:
INFO Checking Windows release
DEBU Running '(Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion" -Name ReleaseId).ReleaseId'
DEBU Command failed: fork/exec C:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exe: Access is denied.
DEBU stdout:
DEBU stderr:
DEBU fork/exec C:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exe: Access is denied.
DEBU Failed to get Windows release id
ERRO Please manually update your Windows 10 installation

curl -i http://localhost:4040/metrics
HTTP/1.1 200 OK
Content-Type: text/plain; version=0.0.4; charset=utf-8
Date: Tue, 29 Jul 2025 12:29:26 GMT
Content-Length: 467

# HELP prometheus_nginxlog_exporter_build_info A metric with a constant '1' value labeled by version, revision, branch, goversion from which prometheus_nginxlog_exporter was built, and the goos and goarch for the build.
# TYPE prometheus_nginxlog_exporter_build_info gauge
prometheus_nginxlog_exporter_build_info{branch="v1.11.0",goarch="amd64",goos="linux",goversion="go1.18.10",revision="76552e7cadc1f76b4e28b5c872412db4a091aca0",tags="unknown",version="1.11.0"} 1

https://accounts.google.com/ServiceLogin?passive=1209600&continue=https://cloud.google.com/innovators/getcertified?mkt_tok%3DODA4LUdKVy0zMTQAAAGcruImhRZWxNA-yz_ANCI54Z2IO0vq38IreIg6-VMIu9HPxNwYAF3LiMNKQIVDoaJ3X7AFLbSrB3uo3sr59IR9YsXzRsPS2n1XjjMaMjFmw2IBfsNXxCI&followup=https://cloud.google.com/innovators/getcertified?mkt_tok%3DODA4LUdKVy0zMTQAAAGcruImhRZWxNA-yz_ANCI54Z2IO0vq38IreIg6-VMIu9HPxNwYAF3LiMNKQIVDoaJ3X7AFLbSrB3uo3sr59IR9YsXzRsPS2n1XjjMaMjFmw2IBfsNXxCI


local.file_match "app_logs" {
  path_targets = [{ "__path__" = "/logs/*.log" }]
}

loki.source.file "app_logs" {
  targets    = local.file_match.app_logs.targets
  forward_to = [loki.process.add_app_labels.receiver]
}

loki.process "add_app_labels" {
  stage.static_labels {
    values = {
      service_name = "Starter"
      pod_name     = "linux-host"  # Replace or set via env("HOSTNAME") if needed
    }
  }
  forward_to = [loki.write.default.receiver]
}

loki.write "default" {
  endpoint {
    url = "http://localhost:3100/loki/api/v1/push"
  }
}


server {
    listen 80;
    server_name yourdomain.com;

    location /grafana/ {
        proxy_pass         http://localhost:3000/;
        proxy_set_header   Host $host;
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
        rewrite ^/grafana/(.*) /$1 break;
    }
}


[server]
root_url = http://192.168.1.100/grafana/
serve_from_sub_path = true


auth_enabled: false

server:
  http_listen_port: 3100
  log_level: info

ingester:
  lifecycler:
    ring:
      kvstore:
        store: inmemory
      replication_factor: 1
  final_sleep: 0s
  chunk_idle_period: 5m
  max_chunk_age: 1h

schema_config:
  configs:
    - from: 2024-01-01
      store: boltdb-shipper
      object_store: filesystem
      schema: v13
      index:
        prefix: index_
        period: 24h

storage_config:
  boltdb_shipper:
    active_index_directory: /tmp/loki/index
    cache_location: /tmp/loki/boltdb-cache
    shared_store: filesystem
  filesystem:
    directory: /tmp/loki/chunks

limits_config:
  enforce_metric_name: false
  reject_old_samples: true
  reject_old_samples_max_age: 168h

chunk_store_config:
  max_look_back_period: 0s

table_manager:
  retention_deletes_enabled: false
  retention_period: 0s


server "http" {
  listen_address = "0.0.0.0:12345" # Alloy UI/metrics port
  log_level      = "info"
}

local.file_match "app_logs" {
  path_targets = {
    "app" = "/uat/xsys/app.log"
  }
  forward_to = [loki.write.default.receiver]
}

loki.write "default" {
  endpoint {
    url = "http://localhost:3100/loki/api/v1/push"
  }
}
