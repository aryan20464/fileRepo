location /fileUpload {
    # Allow up to 200MB file uploads (adjust as needed)
    client_max_body_size 200M;

    # Increase timeouts for slower uploads
    proxy_connect_timeout       300s;
    proxy_send_timeout          300s;
    proxy_read_timeout          300s;
    send_timeout                300s;

    # Buffer settings to handle larger bodies and headers
    client_body_buffer_size     10M;
    proxy_buffer_size           512k;
    proxy_buffers               16 512k;
    proxy_busy_buffers_size     1M;
    proxy_temp_file_write_size  2M;

    # Pass the request to your backend service
    proxy_pass http://middlewarecicdservice;

    # Preserve host and headers
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
